import{d as u,r,h as d,R as l,o as _,c as p,a as w,Q as m,_ as b}from"./index-76c60e35.js";import{g as f}from"./index-751a38a1.js";const v={class:"aaa"},y=u({__name:"sameScreen-webRTCAnswer",setup(C){const i=m(),t=r(i.query.userId),s=r();return d(async()=>{const e=new RTCPeerConnection({iceServers:[{urls:"stun:127.0.0.1:3478"}]});e.ontrack=n=>{s.value.srcObject=n.streams[0],s.value.onloadedmetadata=function(c){s.value.play()}};const{send:a}=f("ws://123.60.16.78:50200/websocket/websocket",{async onMessage(n,c){const o=JSON.parse(c.data);if(o.userId===t.value)switch(o.emit){case"webrtcStart":await e.setRemoteDescription(new RTCSessionDescription(o.data)),await e.setLocalDescription(await e.createAnswer()),a(JSON.stringify({emit:"webrtcResponse",data:e.localDescription,userId:t.value}));break}},onConnected(){a(JSON.stringify({emit:"webrtcLogin",userId:t.value}))}})}),l(e=>{console.log(e)}),(e,a)=>(_(),p("div",v,[w("video",{class:"w-100% h-100% object-contain absolute",ref_key:"video",ref:s,muted:"",autoplay:""},null,512)]))}});const k=b(y,[["__scopeId","data-v-31c7e9fb"]]);export{k as default};
