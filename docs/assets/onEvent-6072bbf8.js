import{O as nt,R as gn,V as En}from"./BaseThree-2edc0656.js";class tt{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const f=e[r],a=t+f,c=Math.abs(t)<Math.abs(f)?t-(a-f):f-(a-t);c&&(e[i++]=c),t=a}return e[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let e=this._n,i,r,f,a=0;if(e>0){for(a=t[--e];e>0&&(i=a,r=t[--e],a=i+r,f=r-(a-i),!f););e>0&&(f<0&&t[e-1]<0||f>0&&t[e-1]>0)&&(r=f*2,i=a+r,r==i-a&&(a=i))}return a}}function*it(n){for(const t of n)yield*t}function $n(n){return Array.from(it(n))}var A=1e-6,et=1e-12,C=Math.PI,k=C/2,zn=C/4,V=C*2,X=180/C,_=C/180,B=Math.abs,jn=Math.atan,nn=Math.atan2,F=Math.cos,rt=Math.exp,ot=Math.log,H=Math.sin,ut=Math.sign||function(n){return n>0?1:n<0?-1:0},vn=Math.sqrt,lt=Math.tan;function ft(n){return n>1?0:n<-1?C:Math.acos(n)}function tn(n){return n>1?k:n<-1?-k:Math.asin(n)}function x(){}function cn(n,t){n&&mn.hasOwnProperty(n.type)&&mn[n.type](n,t)}var An={Feature:function(n,t){cn(n.geometry,t)},FeatureCollection:function(n,t){for(var e=n.features,i=-1,r=e.length;++i<r;)cn(e[i].geometry,t)}},mn={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var e=n.coordinates,i=-1,r=e.length;++i<r;)n=e[i],t.point(n[0],n[1],n[2])},LineString:function(n,t){Mn(n.coordinates,t,0)},MultiLineString:function(n,t){for(var e=n.coordinates,i=-1,r=e.length;++i<r;)Mn(e[i],t,0)},Polygon:function(n,t){Bn(n.coordinates,t)},MultiPolygon:function(n,t){for(var e=n.coordinates,i=-1,r=e.length;++i<r;)Bn(e[i],t)},GeometryCollection:function(n,t){for(var e=n.geometries,i=-1,r=e.length;++i<r;)cn(e[i],t)}};function Mn(n,t,e){var i=-1,r=n.length-e,f;for(t.lineStart();++i<r;)f=n[i],t.point(f[0],f[1],f[2]);t.lineEnd()}function Bn(n,t){var e=-1,i=n.length;for(t.polygonStart();++e<i;)Mn(n[e],t,1);t.polygonEnd()}function at(n,t){n&&An.hasOwnProperty(n.type)?An[n.type](n,t):cn(n,t)}function Ln(n){return[nn(n[1],n[0]),tn(n[2])]}function Q(n){var t=n[0],e=n[1],i=F(e);return[i*F(t),i*H(t),H(e)]}function on(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function sn(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function dn(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function un(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function Pn(n){var t=vn(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function Tn(n,t){function e(i,r){return i=n(i,r),t(i[0],i[1])}return n.invert&&t.invert&&(e.invert=function(i,r){return i=t.invert(i,r),i&&n.invert(i[0],i[1])}),e}function Rn(n,t){return B(n)>C&&(n-=Math.round(n/V)*V),[n,t]}Rn.invert=Rn;function Jn(n,t,e){return(n%=V)?t||e?Tn(Fn(n),Hn(t,e)):Fn(n):t||e?Hn(t,e):Rn}function Dn(n){return function(t,e){return t+=n,B(t)>C&&(t-=Math.round(t/V)*V),[t,e]}}function Fn(n){var t=Dn(n);return t.invert=Dn(-n),t}function Hn(n,t){var e=F(n),i=H(n),r=F(t),f=H(t);function a(c,g){var v=F(g),u=F(c)*v,o=H(c)*v,l=H(g),p=l*e+u*i;return[nn(o*r-p*f,u*e-l*i),tn(p*r+o*f)]}return a.invert=function(c,g){var v=F(g),u=F(c)*v,o=H(c)*v,l=H(g),p=l*r-o*f;return[nn(o*r+l*f,u*e+p*i),tn(p*e-u*i)]},a}function ct(n){n=Jn(n[0]*_,n[1]*_,n.length>2?n[2]*_:0);function t(e){return e=n(e[0]*_,e[1]*_),e[0]*=X,e[1]*=X,e}return t.invert=function(e){return e=n.invert(e[0]*_,e[1]*_),e[0]*=X,e[1]*=X,e},t}function st(n,t,e,i,r,f){if(e){var a=F(t),c=H(t),g=i*e;r==null?(r=t+i*V,f=t-g/2):(r=_n(a,r),f=_n(a,f),(i>0?r<f:r>f)&&(r+=i*V));for(var v,u=r;i>0?u>f:u<f;u-=g)v=Ln([a,-c*F(u),-c*H(u)]),n.point(v[0],v[1])}}function _n(n,t){t=Q(t),t[0]-=n,Pn(t);var e=ft(-t[1]);return((-t[2]<0?-e:e)+V-A)%V}function Kn(){var n=[],t;return{point:function(e,i,r){t.push([e,i,r])},lineStart:function(){n.push(t=[])},lineEnd:x,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var e=n;return n=[],t=null,e}}}function an(n,t){return B(n[0]-t[0])<A&&B(n[1]-t[1])<A}function ln(n,t,e,i){this.x=n,this.z=t,this.o=e,this.e=i,this.v=!1,this.n=this.p=null}function Qn(n,t,e,i,r){var f=[],a=[],c,g;if(n.forEach(function(h){if(!((w=h.length-1)<=0)){var w,E=h[0],T=h[w],S;if(an(E,T)){if(!E[2]&&!T[2]){for(r.lineStart(),c=0;c<w;++c)r.point((E=h[c])[0],E[1]);r.lineEnd();return}T[0]+=2*A}f.push(S=new ln(E,h,null,!0)),a.push(S.o=new ln(E,null,S,!1)),f.push(S=new ln(T,h,null,!1)),a.push(S.o=new ln(T,null,S,!0))}}),!!f.length){for(a.sort(t),Gn(f),Gn(a),c=0,g=a.length;c<g;++c)a[c].e=e=!e;for(var v=f[0],u,o;;){for(var l=v,p=!0;l.v;)if((l=l.n)===v)return;u=l.z,r.lineStart();do{if(l.v=l.o.v=!0,l.e){if(p)for(c=0,g=u.length;c<g;++c)r.point((o=u[c])[0],o[1]);else i(l.x,l.n.x,1,r);l=l.n}else{if(p)for(u=l.p.z,c=u.length-1;c>=0;--c)r.point((o=u[c])[0],o[1]);else i(l.x,l.p.x,-1,r);l=l.p}l=l.o,u=l.z,p=!p}while(!l.v);r.lineEnd()}}}function Gn(n){if(t=n.length){for(var t,e=0,i=n[0],r;++e<t;)i.n=r=n[e],r.p=i,i=r;i.n=r=n[0],r.p=i}}function Sn(n){return B(n[0])<=C?n[0]:ut(n[0])*((B(n[0])+C)%V-C)}function pt(n,t){var e=Sn(t),i=t[1],r=H(i),f=[H(e),-F(e),0],a=0,c=0,g=new tt;r===1?i=k+A:r===-1&&(i=-k-A);for(var v=0,u=n.length;v<u;++v)if(l=(o=n[v]).length)for(var o,l,p=o[l-1],h=Sn(p),w=p[1]/2+zn,E=H(w),T=F(w),S=0;S<l;++S,h=d,E=P,T=N,p=M){var M=o[S],d=Sn(M),L=M[1]/2+zn,P=H(L),N=F(L),O=d-h,I=O>=0?1:-1,m=I*O,y=m>C,q=E*P;if(g.add(nn(q*I*H(m),T*N+q*F(m))),a+=y?O+I*V:O,y^h>=e^d>=e){var D=sn(Q(p),Q(M));Pn(D);var z=sn(f,D);Pn(z);var s=(y^O>=0?-1:1)*tn(z[2]);(i>s||i===s&&(D[0]||D[1]))&&(c+=y^O>=0?1:-1)}}return(a<-A||a<A&&g<-et)^c&1}function Un(n,t,e,i){return function(r){var f=t(r),a=Kn(),c=t(a),g=!1,v,u,o,l={point:p,lineStart:w,lineEnd:E,polygonStart:function(){l.point=T,l.lineStart=S,l.lineEnd=M,u=[],v=[]},polygonEnd:function(){l.point=p,l.lineStart=w,l.lineEnd=E,u=$n(u);var d=pt(v,i);u.length?(g||(r.polygonStart(),g=!0),Qn(u,vt,d,e,r)):d&&(g||(r.polygonStart(),g=!0),r.lineStart(),e(null,null,1,r),r.lineEnd()),g&&(r.polygonEnd(),g=!1),u=v=null},sphere:function(){r.polygonStart(),r.lineStart(),e(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function p(d,L){n(d,L)&&r.point(d,L)}function h(d,L){f.point(d,L)}function w(){l.point=h,f.lineStart()}function E(){l.point=p,f.lineEnd()}function T(d,L){o.push([d,L]),c.point(d,L)}function S(){c.lineStart(),o=[]}function M(){T(o[0][0],o[0][1]),c.lineEnd();var d=c.clean(),L=a.result(),P,N=L.length,O,I,m;if(o.pop(),v.push(o),o=null,!!N){if(d&1){if(I=L[0],(O=I.length-1)>0){for(g||(r.polygonStart(),g=!0),r.lineStart(),P=0;P<O;++P)r.point((m=I[P])[0],m[1]);r.lineEnd()}return}N>1&&d&2&&L.push(L.pop().concat(L.shift())),u.push(L.filter(ht))}}return l}}function ht(n){return n.length>1}function vt(n,t){return((n=n.x)[0]<0?n[1]-k-A:k-n[1])-((t=t.x)[0]<0?t[1]-k-A:k-t[1])}const qn=Un(function(){return!0},gt,dt,[-C,-k]);function gt(n){var t=NaN,e=NaN,i=NaN,r;return{lineStart:function(){n.lineStart(),r=1},point:function(f,a){var c=f>0?C:-C,g=B(f-t);B(g-C)<A?(n.point(t,e=(e+a)/2>0?k:-k),n.point(i,e),n.lineEnd(),n.lineStart(),n.point(c,e),n.point(f,e),r=0):i!==c&&g>=C&&(B(t-i)<A&&(t-=i*A),B(f-c)<A&&(f-=c*A),e=Et(t,e,f,a),n.point(i,e),n.lineEnd(),n.lineStart(),n.point(c,e),r=0),n.point(t=f,e=a),i=c},lineEnd:function(){n.lineEnd(),t=e=NaN},clean:function(){return 2-r}}}function Et(n,t,e,i){var r,f,a=H(n-e);return B(a)>A?jn((H(t)*(f=F(i))*H(e)-H(i)*(r=F(t))*H(n))/(r*f*a)):(t+i)/2}function dt(n,t,e,i){var r;if(n==null)r=e*k,i.point(-C,r),i.point(0,r),i.point(C,r),i.point(C,0),i.point(C,-r),i.point(0,-r),i.point(-C,-r),i.point(-C,0),i.point(-C,r);else if(B(n[0]-t[0])>A){var f=n[0]<t[0]?C:-C;r=e*f/2,i.point(-f,r),i.point(0,r),i.point(f,r)}else i.point(t[0],t[1])}function St(n){var t=F(n),e=6*_,i=t>0,r=B(t)>A;function f(u,o,l,p){st(p,n,e,l,u,o)}function a(u,o){return F(u)*F(o)>t}function c(u){var o,l,p,h,w;return{lineStart:function(){h=p=!1,w=1},point:function(E,T){var S=[E,T],M,d=a(E,T),L=i?d?0:v(E,T):d?v(E+(E<0?C:-C),T):0;if(!o&&(h=p=d)&&u.lineStart(),d!==p&&(M=g(o,S),(!M||an(o,M)||an(S,M))&&(S[2]=1)),d!==p)w=0,d?(u.lineStart(),M=g(S,o),u.point(M[0],M[1])):(M=g(o,S),u.point(M[0],M[1],2),u.lineEnd()),o=M;else if(r&&o&&i^d){var P;!(L&l)&&(P=g(S,o,!0))&&(w=0,i?(u.lineStart(),u.point(P[0][0],P[0][1]),u.point(P[1][0],P[1][1]),u.lineEnd()):(u.point(P[1][0],P[1][1]),u.lineEnd(),u.lineStart(),u.point(P[0][0],P[0][1],3)))}d&&(!o||!an(o,S))&&u.point(S[0],S[1]),o=S,p=d,l=L},lineEnd:function(){p&&u.lineEnd(),o=null},clean:function(){return w|(h&&p)<<1}}}function g(u,o,l){var p=Q(u),h=Q(o),w=[1,0,0],E=sn(p,h),T=on(E,E),S=E[0],M=T-S*S;if(!M)return!l&&u;var d=t*T/M,L=-t*S/M,P=sn(w,E),N=un(w,d),O=un(E,L);dn(N,O);var I=P,m=on(N,I),y=on(I,I),q=m*m-y*(on(N,N)-1);if(!(q<0)){var D=vn(q),z=un(I,(-m-D)/y);if(dn(z,N),z=Ln(z),!l)return z;var s=u[0],R=o[0],G=u[1],W=o[1],Y;R<s&&(Y=s,s=R,R=Y);var Z=R-s,$=B(Z-C)<A,J=$||Z<A;if(!$&&W<G&&(Y=G,G=W,W=Y),J?$?G+W>0^z[1]<(B(z[0]-s)<A?G:W):G<=z[1]&&z[1]<=W:Z>C^(s<=z[0]&&z[0]<=R)){var j=un(I,(-m+D)/y);return dn(j,N),[z,Ln(j)]}}}function v(u,o){var l=i?n:C-n,p=0;return u<-l?p|=1:u>l&&(p|=2),o<-l?p|=4:o>l&&(p|=8),p}return Un(a,c,f,i?[0,-n]:[-C,n-C])}function wt(n,t,e,i,r,f){var a=n[0],c=n[1],g=t[0],v=t[1],u=0,o=1,l=g-a,p=v-c,h;if(h=e-a,!(!l&&h>0)){if(h/=l,l<0){if(h<u)return;h<o&&(o=h)}else if(l>0){if(h>o)return;h>u&&(u=h)}if(h=r-a,!(!l&&h<0)){if(h/=l,l<0){if(h>o)return;h>u&&(u=h)}else if(l>0){if(h<u)return;h<o&&(o=h)}if(h=i-c,!(!p&&h>0)){if(h/=p,p<0){if(h<u)return;h<o&&(o=h)}else if(p>0){if(h>o)return;h>u&&(u=h)}if(h=f-c,!(!p&&h<0)){if(h/=p,p<0){if(h>o)return;h>u&&(u=h)}else if(p>0){if(h<u)return;h<o&&(o=h)}return u>0&&(n[0]=a+u*l,n[1]=c+u*p),o<1&&(t[0]=a+o*l,t[1]=c+o*p),!0}}}}}var b=1e9,fn=-b;function yt(n,t,e,i){function r(v,u){return n<=v&&v<=e&&t<=u&&u<=i}function f(v,u,o,l){var p=0,h=0;if(v==null||(p=a(v,o))!==(h=a(u,o))||g(v,u)<0^o>0)do l.point(p===0||p===3?n:e,p>1?i:t);while((p=(p+o+4)%4)!==h);else l.point(u[0],u[1])}function a(v,u){return B(v[0]-n)<A?u>0?0:3:B(v[0]-e)<A?u>0?2:1:B(v[1]-t)<A?u>0?1:0:u>0?3:2}function c(v,u){return g(v.x,u.x)}function g(v,u){var o=a(v,1),l=a(u,1);return o!==l?o-l:o===0?u[1]-v[1]:o===1?v[0]-u[0]:o===2?v[1]-u[1]:u[0]-v[0]}return function(v){var u=v,o=Kn(),l,p,h,w,E,T,S,M,d,L,P,N={point:O,lineStart:q,lineEnd:D,polygonStart:m,polygonEnd:y};function O(s,R){r(s,R)&&u.point(s,R)}function I(){for(var s=0,R=0,G=p.length;R<G;++R)for(var W=p[R],Y=1,Z=W.length,$=W[0],J,j,rn=$[0],K=$[1];Y<Z;++Y)J=rn,j=K,$=W[Y],rn=$[0],K=$[1],j<=i?K>i&&(rn-J)*(i-j)>(K-j)*(n-J)&&++s:K<=i&&(rn-J)*(i-j)<(K-j)*(n-J)&&--s;return s}function m(){u=o,l=[],p=[],P=!0}function y(){var s=I(),R=P&&s,G=(l=$n(l)).length;(R||G)&&(v.polygonStart(),R&&(v.lineStart(),f(null,null,1,v),v.lineEnd()),G&&Qn(l,c,s,f,v),v.polygonEnd()),u=v,l=p=h=null}function q(){N.point=z,p&&p.push(h=[]),L=!0,d=!1,S=M=NaN}function D(){l&&(z(w,E),T&&d&&o.rejoin(),l.push(o.result())),N.point=O,d&&u.lineEnd()}function z(s,R){var G=r(s,R);if(p&&h.push([s,R]),L)w=s,E=R,T=G,L=!1,G&&(u.lineStart(),u.point(s,R));else if(G&&d)u.point(s,R);else{var W=[S=Math.max(fn,Math.min(b,S)),M=Math.max(fn,Math.min(b,M))],Y=[s=Math.max(fn,Math.min(b,s)),R=Math.max(fn,Math.min(b,R))];wt(W,Y,n,t,e,i)?(d||(u.lineStart(),u.point(W[0],W[1])),u.point(Y[0],Y[1]),G||u.lineEnd(),P=!1):G&&(u.lineStart(),u.point(s,R),P=!1)}S=s,M=R,d=G}return N}}const Wn=n=>n;var U=1/0,pn=U,en=-U,hn=en,Mt={point:Lt,lineStart:x,lineEnd:x,polygonStart:x,polygonEnd:x,result:function(){var n=[[U,pn],[en,hn]];return en=hn=-(pn=U=1/0),n}};function Lt(n,t){n<U&&(U=n),n>en&&(en=n),t<pn&&(pn=t),t>hn&&(hn=t)}const kn=Mt;function On(n){return function(t){var e=new Cn;for(var i in n)e[i]=n[i];return e.stream=t,e}}function Cn(){}Cn.prototype={constructor:Cn,point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function In(n,t,e){var i=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),i!=null&&n.clipExtent(null),at(e,n.stream(kn)),t(kn.result()),i!=null&&n.clipExtent(i),n}function Zn(n,t,e){return In(n,function(i){var r=t[1][0]-t[0][0],f=t[1][1]-t[0][1],a=Math.min(r/(i[1][0]-i[0][0]),f/(i[1][1]-i[0][1])),c=+t[0][0]+(r-a*(i[1][0]+i[0][0]))/2,g=+t[0][1]+(f-a*(i[1][1]+i[0][1]))/2;n.scale(150*a).translate([c,g])},e)}function Pt(n,t,e){return Zn(n,[[0,0],t],e)}function Tt(n,t,e){return In(n,function(i){var r=+t,f=r/(i[1][0]-i[0][0]),a=(r-f*(i[1][0]+i[0][0]))/2,c=-f*i[0][1];n.scale(150*f).translate([a,c])},e)}function Rt(n,t,e){return In(n,function(i){var r=+t,f=r/(i[1][1]-i[0][1]),a=-f*i[0][0],c=(r-f*(i[1][1]+i[0][1]))/2;n.scale(150*f).translate([a,c])},e)}var Xn=16,Ct=F(30*_);function Yn(n,t){return+t?It(n,t):Ot(n)}function Ot(n){return On({point:function(t,e){t=n(t,e),this.stream.point(t[0],t[1])}})}function It(n,t){function e(i,r,f,a,c,g,v,u,o,l,p,h,w,E){var T=v-i,S=u-r,M=T*T+S*S;if(M>4*t&&w--){var d=a+l,L=c+p,P=g+h,N=vn(d*d+L*L+P*P),O=tn(P/=N),I=B(B(P)-1)<A||B(f-o)<A?(f+o)/2:nn(L,d),m=n(I,O),y=m[0],q=m[1],D=y-i,z=q-r,s=S*D-T*z;(s*s/M>t||B((T*D+S*z)/M-.5)>.3||a*l+c*p+g*h<Ct)&&(e(i,r,f,a,c,g,y,q,I,d/=N,L/=N,P,w,E),E.point(y,q),e(y,q,I,d,L,P,v,u,o,l,p,h,w,E))}}return function(i){var r,f,a,c,g,v,u,o,l,p,h,w,E={point:T,lineStart:S,lineEnd:d,polygonStart:function(){i.polygonStart(),E.lineStart=L},polygonEnd:function(){i.polygonEnd(),E.lineStart=S}};function T(O,I){O=n(O,I),i.point(O[0],O[1])}function S(){o=NaN,E.point=M,i.lineStart()}function M(O,I){var m=Q([O,I]),y=n(O,I);e(o,l,u,p,h,w,o=y[0],l=y[1],u=O,p=m[0],h=m[1],w=m[2],Xn,i),i.point(o,l)}function d(){E.point=T,i.lineEnd()}function L(){S(),E.point=P,E.lineEnd=N}function P(O,I){M(r=O,I),f=o,a=l,c=p,g=h,v=w,E.point=M}function N(){e(o,l,u,p,h,w,f,a,r,c,g,v,Xn,i),E.lineEnd=d,d()}return E}}var Nt=On({point:function(n,t){this.stream.point(n*_,t*_)}});function zt(n){return On({point:function(t,e){var i=n(t,e);return this.stream.point(i[0],i[1])}})}function At(n,t,e,i,r){function f(a,c){return a*=i,c*=r,[t+n*a,e-n*c]}return f.invert=function(a,c){return[(a-t)/n*i,(e-c)/n*r]},f}function Vn(n,t,e,i,r,f){if(!f)return At(n,t,e,i,r);var a=F(f),c=H(f),g=a*n,v=c*n,u=a/n,o=c/n,l=(c*e-a*t)/n,p=(c*t+a*e)/n;function h(w,E){return w*=i,E*=r,[g*w-v*E+t,e-v*w-g*E]}return h.invert=function(w,E){return[i*(u*w-o*E+l),r*(p-o*w-u*E)]},h}function mt(n){return Bt(function(){return n})()}function Bt(n){var t,e=150,i=480,r=250,f=0,a=0,c=0,g=0,v=0,u,o=0,l=1,p=1,h=null,w=qn,E=null,T,S,M,d=Wn,L=.5,P,N,O,I,m;function y(s){return O(s[0]*_,s[1]*_)}function q(s){return s=O.invert(s[0],s[1]),s&&[s[0]*X,s[1]*X]}y.stream=function(s){return I&&m===s?I:I=Nt(zt(u)(w(P(d(m=s)))))},y.preclip=function(s){return arguments.length?(w=s,h=void 0,z()):w},y.postclip=function(s){return arguments.length?(d=s,E=T=S=M=null,z()):d},y.clipAngle=function(s){return arguments.length?(w=+s?St(h=s*_):(h=null,qn),z()):h*X},y.clipExtent=function(s){return arguments.length?(d=s==null?(E=T=S=M=null,Wn):yt(E=+s[0][0],T=+s[0][1],S=+s[1][0],M=+s[1][1]),z()):E==null?null:[[E,T],[S,M]]},y.scale=function(s){return arguments.length?(e=+s,D()):e},y.translate=function(s){return arguments.length?(i=+s[0],r=+s[1],D()):[i,r]},y.center=function(s){return arguments.length?(f=s[0]%360*_,a=s[1]%360*_,D()):[f*X,a*X]},y.rotate=function(s){return arguments.length?(c=s[0]%360*_,g=s[1]%360*_,v=s.length>2?s[2]%360*_:0,D()):[c*X,g*X,v*X]},y.angle=function(s){return arguments.length?(o=s%360*_,D()):o*X},y.reflectX=function(s){return arguments.length?(l=s?-1:1,D()):l<0},y.reflectY=function(s){return arguments.length?(p=s?-1:1,D()):p<0},y.precision=function(s){return arguments.length?(P=Yn(N,L=s*s),z()):vn(L)},y.fitExtent=function(s,R){return Zn(y,s,R)},y.fitSize=function(s,R){return Pt(y,s,R)},y.fitWidth=function(s,R){return Tt(y,s,R)},y.fitHeight=function(s,R){return Rt(y,s,R)};function D(){var s=Vn(e,0,0,l,p,o).apply(null,t(f,a)),R=Vn(e,i-s[0],r-s[1],l,p,o);return u=Jn(c,g,v),N=Tn(t,R),O=Tn(u,N),P=Yn(N,L),z()}function z(){return I=m=null,y}return function(){return t=n.apply(this,arguments),y.invert=t.invert&&q,D()}}function Nn(n,t){return[n,ot(lt((k+t)/2))]}Nn.invert=function(n,t){return[n,2*jn(rt(t))-k]};function _t(){return Dt(Nn).scale(961/V)}function Dt(n){var t=mt(n),e=t.center,i=t.scale,r=t.translate,f=t.clipExtent,a=null,c,g,v;t.scale=function(o){return arguments.length?(i(o),u()):i()},t.translate=function(o){return arguments.length?(r(o),u()):r()},t.center=function(o){return arguments.length?(e(o),u()):e()},t.clipExtent=function(o){return arguments.length?(o==null?a=c=g=v=null:(a=+o[0][0],c=+o[0][1],g=+o[1][0],v=+o[1][1]),u()):a==null?null:[[a,c],[g,v]]};function u(){var o=C*i(),l=t(ct(t.rotate()).invert([0,0]));return f(a==null?[[l[0]-o,l[1]-o],[l[0]+o,l[1]+o]]:n===Nn?[[Math.max(l[0]-o,a),c],[Math.min(l[0]+o,g),v]]:[[a,Math.max(l[1]-o,c)],[g,Math.min(l[1]+o,v)]])}return u()}function wn(n){var t=[];for(var e in n){var i=n[e].object3d;t.push(i)}return xn(t)}function xn(n){var t=[];for(var e in n)n[e].type==="Group"?t=t.concat(xn(n[e].children)):t.push(n[e]);return t}function yn(n,t){return bn(n,t)}function bn(n,t){return n[t.id]?n[t.id]:bn(n,t.parent)}class Ft{constructor(t=[]){this.updateCallbackList=t}gaze(t,e){var i=!1,r,f,a=new gn,c=function(){if(t){var g=[];a.setFromCamera(new En,e),g=wn(t);var v=a.intersectObjects(g);v.length>0?i||(i=!0,r=v[0].object,f=yn(t,r),f.callback[0]&&f.callback[0](r)):(i&&f.callback[1]&&f.callback[1](r),i=!1)}};this.updateCallbackList.push(c)}click(t,e,i){var r,f,a=!1,c=new gn;function g(o){var l;const p=o.path||((l=o.composedPath)==null?void 0:l.call(o))||[];if(i&&p.includes(i)||!i){if(!t)return;var h=[];c.setFromCamera(new En((o.clientX-i.getBoundingClientRect().x)/(i.width||window.innerWidth)*2-1,-((o.clientY-i.getBoundingClientRect().y)/(i.height||window.innerHeight))*2+1),e),h=wn(t);var w=c.intersectObjects(h);if(w.length>0){if(a)return;a=!0,r=w[0].object,f=yn(t,r)}else a=!1}}function v(o){var l;const p=o.path||((l=o.composedPath)==null?void 0:l.call(o))||[];(i&&p.includes(i)||!i)&&a&&(a=!1)}function u(o){var l;const p=o.path||((l=o.composedPath)==null?void 0:l.call(o))||[];(i&&p.includes(i)||!i)&&(a&&f.callback[0]&&f.callback[0](r),a=!1)}window.addEventListener("mousedown",g,!1),window.addEventListener("mousemove",v,!1),window.addEventListener("mouseup",u,!1)}hover(t,e,i){var r,f,a=!1,c=new gn;window.addEventListener("mousemove",function(g){var v;const u=g.path||((v=g.composedPath)==null?void 0:v.call(g))||[];if(i&&u.includes(i)||!i){if(!t)return;var o=[];c.setFromCamera(new En((g.clientX-i.getBoundingClientRect().x)/(i.width||window.innerWidth)*2-1,-((g.clientY-i.getBoundingClientRect().y)/(i.height||window.innerHeight))*2+1),e),o=wn(t);var l=c.intersectObjects(o);if(l.length>0){if(a)return;a=!0,r=l[0].object,f=yn(t,r),f.callback[0]&&f.callback[0](r)}else a&&f.callback[1]&&f.callback[1](r),a=!1}},!1)}}class Gt{constructor(t,e,i){this.scene=t,this.camera=e,this.el=i,this.updateCallbackList=[],this.TargetList=new Ft(this.updateCallbackList),this.EventListeners={},this.listenerList=this.TargetList,this.option={scene:t,camera:e,el:i},Object.keys(this.TargetList).concat(["gaze","click","hover"]).forEach((r,f)=>{this.EventListeners[r]={flag:!1,listener:a=>{this.listenerList[r](a,this.option.camera,this.option.el)}}}),this.init()}init(){const t=this;Object.assign(nt.prototype,{on:function(e,i,r){if(t.EventListeners.hasOwnProperty(e)){t.TargetList[e][this.id]={object3d:this,callback:Array.from(arguments).slice(1)};var f=t.EventListeners[e];f.flag||(f.flag=!0,f.listener(t.TargetList[e]))}else console.warn("There is no method called '"+e+"';")},off:function(e){if(e)t.EventListeners.hasOwnProperty(e)?delete t.TargetList[e][this.id]:console.warn("There is no method called '"+e+"';");else for(const i in t.TargetList)delete t.TargetList[i][this.id]}})}removeAll(){for(var t in this.TargetList)for(var e in this.TargetList[t])delete this.TargetList[t][e]}update(){for(var t in this.updateCallbackList)this.updateCallbackList[t]()}}export{_t as g,Gt as o};
