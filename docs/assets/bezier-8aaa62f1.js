import{s as B}from"./index-1159d8e2.js";import{s as M}from"./transform-c376ec3f.js";import{d as w,r as A,h as Q,o as k,c as E,a as I,B as S,u as g,_ as T}from"./index-bfc7e514.js";const V={class:"a"},q=w({__name:"bezier",setup(D){const y=A({x:0,y:0}),h=(e,t,s,c,o)=>(1-e)**3*t+3*(1-e)**2*e*s+3*(1-e)*e**2*c+e**3*o;function d(e,t){const s=t.x-e.x,c=t.y-e.y;return Math.sqrt(s*s+c*c)}function _(e,t,s,c,o){const n=1-o,r=n*n,i=r*n,a=o*o,l=a*o,p=i*e.x+3*r*o*t.x+3*n*a*s.x+l*c.x,u=i*e.y+3*r*o*t.y+3*n*a*s.y+l*c.y;return{x:p,y:u}}function f(e,t,s,c,o){let n=0,r=e;for(let i=1;i<=o;i++){const a=i/o,l=_(e,t,s,c,a),p=d(r,l);n+=p,r=l}return n}class b{constructor(t){this.points=t}isType(t){return typeof t.type=="string"}isM(t){return t.type==="M"}isL(t){return t.type==="L"}isQ(t){return t.type==="Q"}isC(t){return t.type==="C"||t.p1||t.p2}toString(){let t="";return this.points.forEach((s,c)=>{var n,r,i,a;const o=this.isC(s)?"C":this.isL(s)?"L":this.isQ(s)?"Q":this.isL(s)?"L":!this.isType(s)&&c===0?"M":"L";t+=`${o}
             ${((n=s==null?void 0:s.p1)==null?void 0:n.x)||""}
             ${((r=s==null?void 0:s.p1)==null?void 0:r.y)||""}
             ${((i=s==null?void 0:s.p2)==null?void 0:i.x)||""}
             ${((a=s==null?void 0:s.p2)==null?void 0:a.y)||""}
             ${s.x} ${s.y} `}),t.replace(/\s+/g," ").trim()}bezierLength(t=100){let s=0,c=[],o=null;return this.points.forEach(n=>{if(o&&this.isC(n)){const r=f(o,n.p1,n.p2,n,t);s+=r,c.push(r)}o=n}),{length:s,lengthArrs:c}}}const m=async()=>{const e=new b([{x:0,y:0},{x:500,y:500,p1:{x:100,y:200},p2:{x:300,y:300}},{x:100,y:100,p1:{x:500,y:500},p2:{x:100,y:100}}]),t=e.bezierLength(),s=t.lengthArrs.map(n=>n/t.length).map((n,r,i)=>i.slice(0,r).reduce((a,l)=>a+l,0)),c=t.lengthArrs.map(n=>n/t.length);console.log(s),M("body").append("svg").attr("width",500).attr("height",500).attr("class","w-500px h-500px b b-#f00 b-solid").append("path").attr("d",e.toString()).attr("fill","#f000").attr("stroke","#f00"),await B(n=>{const r=t.lengthArrs.findIndex((N,v,L)=>{const $=L.slice(0,v+1).reduce((z,C)=>z+C,0);return t.length*n<=$}),i=1/c[r]*(n-s[r]),a=e.points[r],{x:l,y:p,p1:u,p2:x}=e.points[r+1];y.value={x:h(i,a.x,u.x,x.x,l),y:h(i,a.y,u.y,x.y,p)}},3e3)};return Q(async()=>{await m()}),(e,t)=>(k(),E("div",V,[I("div",{class:"bg-#f00 w-10px h-10px b-rd-10px absolute",style:S({left:`${g(y).x}px`,top:`${g(y).y}px`})},null,4)]))}});const H=T(q,[["__scopeId","data-v-b6b33bc2"]]);export{H as default};
