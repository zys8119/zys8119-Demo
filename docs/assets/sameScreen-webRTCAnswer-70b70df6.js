import{d,r as i,h as u,T as l,o as _,c as p,a as m,S as w,_ as v}from"./index-ee812f84.js";import{g as b}from"./index-fc4fb02a.js";const f={class:"aaa"},y=d({__name:"sameScreen-webRTCAnswer",setup(S){const n=w(),t=i(n.query.userId),s=i();return u(async()=>{const e=new RTCPeerConnection({iceServers:[{urls:"stun:127.0.0.1:3478"}]});e.ontrack=r=>{s.value.srcObject=r.streams[0],s.value.onloadedmetadata=function(c){s.value.play()}};const{send:a}=b(n.query.wsUrl,{async onMessage(r,c){const o=JSON.parse(c.data);if(o.userId===t.value)switch(o.emit){case"webrtcStart":await e.setRemoteDescription(new RTCSessionDescription(o.data)),await e.setLocalDescription(await e.createAnswer()),a(JSON.stringify({emit:"webrtcResponse",data:e.localDescription,userId:t.value}));break}},onConnected(){a(JSON.stringify({emit:"webrtcLogin",userId:t.value}))}})}),l(e=>{console.log(e)}),(e,a)=>(_(),p("div",f,[m("video",{class:"w-100% h-100% object-contain absolute",ref_key:"video",ref:s,muted:"",autoplay:""},null,512)]))}});const g=v(y,[["__scopeId","data-v-5346d4db"]]);export{g as default};
