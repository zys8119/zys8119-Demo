import{d as h,r as d,h as w,T as S,o as f,c as u,a as t,F as y,b,t as x,S as E,p as D,e as k,_ as I}from"./index-ee812f84.js";import{g as P}from"./index-fc4fb02a.js";const i=n=>(D("data-v-3ca4df10"),n=n(),k(),n),R={class:"aaa"},L=i(()=>t("h1",null,"这是同屏的内容区域",-1)),T=i(()=>t("div",{class:"text-#fff bg-#f00"},"阿斯科利大量三等奖",-1)),B=i(()=>t("div",{class:"text-#fff bg-#f00 flex justify-between"},[t("span",null,"left"),t("span",null,"right")],-1)),C=h({__name:"sameScreenPage",setup(n){const{query:l}=E(),{send:_,ws:p}=P(l.wsUrl,{autoReconnect:!0}),g=d(),m=d(),c={},v=async(s,a)=>{const e=new RTCPeerConnection({iceServers:[{urls:"stun:127.0.0.1:3478"}]});s.getTracks().forEach(r=>{e.addTrack(r,s)});let o=!1;return e.onicecandidate=r=>{r.candidate&&!o&&(o=!0,a==null||a(e))},await e.setLocalDescription(await e.createOffer()),e};return w(async()=>{const s=await navigator.mediaDevices.getDisplayMedia();p.value.addEventListener("message",async a=>{const e=JSON.parse(a.data)||{};switch(e.emit){case"webrtcLogin":c[e.userId]=await v(s,o=>{_(JSON.stringify({emit:"webrtcStart",data:o.localDescription,userId:e.userId}))});break;case"webrtcResponse":c[e.userId]&&await c[e.userId].setRemoteDescription(e.data);break}})}),S(s=>{console.log(s)}),(s,a)=>(f(),u("div",R,[t("canvas",{ref_key:"canvas",ref:g,class:"hidden w=0 h-0"},null,512),t("div",{ref_key:"contentEl",ref:m,id:"contentEl",class:"bg-#fff w-100% h-100% absolute of-x-hidden"},[L,T,B,(f(),u(y,null,b(100,e=>t("div",null,x(e),1)),64))],512)]))}});const O=I(C,[["__scopeId","data-v-3ca4df10"]]);export{O as default};
