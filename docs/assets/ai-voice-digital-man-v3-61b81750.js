import{d as N,r as i,h as Y,o as G,c as J,a as e,C as K,D as _,n as g,u as n,p as O,e as Q,_ as X}from"./index-56450848.js";import{t as Z,q as ee,m as te}from"./ai-b-cf3f840e.js";import{l as ae}from"./lodash-d2667470.js";import{S as v}from"./svg-icon-dc13268a.js";import{b as se}from"./index-ada85e10.js";import"./_commonjsHelpers-87174ba5.js";import"./format-length-c9d165c6.js";const j=""+new URL("ai-bainian-c48efd1f.mp4",import.meta.url).href,B=""+new URL("ai-jieshu-ee0e832d.mp4",import.meta.url).href,oe=""+new URL("bg-c56a087a.mp3",import.meta.url).href,w=d=>(O("data-v-40f8aea7"),d=d(),Q(),d),ne={class:"ai-voice bg-#f7d6b8 abs-content of-hidden"},ie=["src"],ce=["src"],re=["src"],le=["src"],pe=["src"],de=["src"],fe=["src"],ue=["src"],me={class:"abs-end-bottom rigth-30px bottom-30px flex-center gap-5px flex-col items-end text-50px text-#ff0052"},he=["onClick"],_e=w(()=>e("div",{class:"text-14px"},"背景音乐",-1)),ge=w(()=>e("div",{class:"text-14px"},"全屏",-1)),ve=["onClick"],we=w(()=>e("div",{class:"text-14px"},"拜年",-1)),be=["onClick"],ye=w(()=>e("div",{class:"text-14px"},"结语",-1)),xe={class:"abs-r z--1"},ke=["src"],Re=["src"],Se=["src"],Ce=N({__name:"ai-voice-digital-man-v3",setup(d){const{toggle:R}=se(),r=i(),S=i(),C=i(),D=async()=>{r.value.paused?r.value.play():r.value.pause()},z=Z({similarity:.4,smoothness:.05,spill:.05}),b=async(t,a,o)=>{const{clip:p,mp4Info:c}=o;async function T(F=0,u,W,$){const A=Number((c.duration/c.timescale).toFixed(0));typeof u!="number"&&(u=A);const x=u-F,E=(W||x)*1e3,P=async m=>{const k=$?u-x*m:F+x*m,h=await p.getVideoFrame(k);if(h){a.clearRect(0,0,a.canvas.width,a.canvas.height);const s=await z(h);a.drawImage(s,0,0,s.codedWidth,s.codedHeight,(a.canvas.width-s.codedWidth)/2,a.canvas.height-s.codedHeight,s.codedWidth,s.codedHeight)}};return new Promise(m=>{const k=performance.now();(async function h(){const s=(performance.now()-k)/E;if(s>1){await P(1),m();return}await P(s),requestAnimationFrame(h)})()})}return T},y=async t=>{const a=await fetch(t),o=new ee(a.body),p=await o.ready,c=await o.getInfo();return{clip:o,mp4Info:c,body:p}},I=i(),q=i(),M=i(),V=i(),l=i(!1),f=async t=>{await I.value(2.9,3.3,2,t),l.value||await f(!t)},U=ae.debounce(async(t,a)=>{t.width=window.innerWidth*window.devicePixelRatio,t.height=window.innerHeight*window.devicePixelRatio},300);Y(async()=>{r.value.volume=.05;const t=V.value,a=t.getContext("2d"),o=await y(te);I.value=await b(t,a,o);const p=await y(j);q.value=await b(t,a,p);const c=await y(B);M.value=await b(t,a,c),U(t,a),window.addEventListener("resize",()=>{U(t,a)}),await f()});const H=async()=>{l.value=!0,setTimeout(()=>{requestAnimationFrame(async()=>{S.value.play(),await q.value(),l.value=!1,await f()})},2e3)},L=async()=>{l.value=!0,setTimeout(()=>{requestAnimationFrame(async()=>{C.value.play(),await M.value(),l.value=!1,await f()})},2e3)};return(t,a)=>(G(),J("div",ne,[e("img",{class:"abs-content bg",src:"./ai/bg.png",alt:""},null,8,ie),e("img",{class:"abs-start-bottom w-100% footer",src:"./ai/footer.png",alt:""},null,8,ce),e("img",{class:"abs-start-bottom house",src:"./ai/house-left.png",alt:""},null,8,re),e("img",{class:"abs-end-bottom house",src:"./ai/house-right.png",alt:""},null,8,le),e("img",{class:"abs-start w-183px left-13% top-5% yun-up",src:"./ai/yun-up.png",alt:""},null,8,pe),e("img",{class:"abs-end-bottom right-13% bottom-30px yun-down",src:"./ai/yun-down.png",alt:""},null,8,de),e("img",{class:"abs-start w-300px top-10% left--70px jack-left",src:"./ai/jack-left.png",alt:""},null,8,fe),e("img",{class:"abs-end w-300px top-10% right--70px jack-right",src:"./ai/jack-right.png",alt:""},null,8,ue),e("canvas",{class:"abs-content",ref_key:"canvasRef",ref:V,style:K(`transform: scale(${t.$route.query.scale||1}) translateY(${t.$route.query.y||0}%)`)},null,4),e("div",me,[e("div",{class:"bg-#fff1 hover:bg-#fff5 w-100px p-15px b-rd-y-10px cursor-pointer flex-center flex-col",onClick:_(D,["stop"])},[g(n(v),{name:"yinyue"}),_e],8,he),e("div",{class:"bg-#fff1 hover:bg-#fff5 w-100px p-15px b-rd-y-10px cursor-pointer flex-center flex-col",onClick:a[0]||(a[0]=_((...o)=>n(R)&&n(R)(...o),["stop"]))},[g(n(v),{name:"quanping"}),ge]),e("div",{class:"bg-#fff1 hover:bg-#fff5 w-100px p-15px b-rd-y-10px cursor-pointer flex-center flex-col",onClick:_(H,["stop"])},[g(n(v),{name:"bainian"}),we],8,ve),e("div",{class:"bg-#fff1 hover:bg-#fff5 w-100px p-15px b-rd-y-10px cursor-pointer flex-center flex-col",onClick:_(L,["stop"])},[g(n(v),{name:"fu","not-fill":""}),ye],8,be)]),e("div",xe,[e("audio",{src:n(oe),autoplay:"",ref_key:"audioRef",ref:r,loop:""},null,8,ke),e("video",{ref_key:"bainianRef",ref:S,src:n(j)},null,8,Re),e("video",{ref_key:"perorationRef",ref:C,src:n(B)},null,8,Se)])]))}});const je=X(Ce,[["__scopeId","data-v-40f8aea7"]]);export{je as default};
