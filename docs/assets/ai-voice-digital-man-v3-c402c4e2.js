import{d as G,r as i,h as J,o as K,c as O,a as e,D as _,n as g,u as n,p as Q,e as X,_ as Y}from"./index-3551bf4b.js";import{t as Z,q as $,m as ee}from"./ai-b-cf3f840e.js";import{l as te}from"./lodash-d2667470.js";import{S as v}from"./svg-icon-cf0dcd7b.js";import{b as ae}from"./index-70468c8b.js";import"./_commonjsHelpers-87174ba5.js";import"./format-length-c9d165c6.js";const j=""+new URL("ai-bainian-c48efd1f.mp4",import.meta.url).href,B=""+new URL("ai-jieshu-ee0e832d.mp4",import.meta.url).href,oe=""+new URL("bg-c56a087a.mp3",import.meta.url).href,w=d=>(Q("data-v-c791f772"),d=d(),X(),d),se={class:"ai-voice bg-#f7d6b8 abs-content of-hidden"},ne=["src"],ie=["src"],ce=["src"],re=["src"],le=["src"],pe=["src"],de=["src"],fe=["src"],ue={class:"abs-end-bottom rigth-30px bottom-30px flex-center gap-5px flex-col items-end text-50px text-#ff0052"},me=["onClick"],he=w(()=>e("div",{class:"text-14px"},"背景音乐",-1)),_e=w(()=>e("div",{class:"text-14px"},"全屏",-1)),ge=["onClick"],ve=w(()=>e("div",{class:"text-14px"},"拜年",-1)),we=["onClick"],be=w(()=>e("div",{class:"text-14px"},"结语",-1)),xe={class:"abs-r z--1"},ye=["src"],ke=["src"],Re=["src"],Se=G({__name:"ai-voice-digital-man-v3",setup(d){const{toggle:R}=ae(),r=i(),S=i(),C=i(),D=async()=>{r.value.paused?r.value.play():r.value.pause()},H=Z({similarity:.4,smoothness:.05,spill:.05}),b=async(a,t,s)=>{const{clip:p,mp4Info:c}=s;async function W(F=0,u,z,A){const E=Number((c.duration/c.timescale).toFixed(0));typeof u!="number"&&(u=E);const y=u-F,N=(z||y)*1e3,P=async m=>{const k=A?u-y*m:F+y*m,h=await p.getVideoFrame(k);if(h){t.clearRect(0,0,t.canvas.width,t.canvas.height);const o=await H(h);t.drawImage(o,0,0,o.codedWidth,o.codedHeight,(t.canvas.width-o.codedWidth)/2,t.canvas.height-o.codedHeight,o.codedWidth,o.codedHeight)}};return new Promise(m=>{const k=performance.now();(async function h(){const o=(performance.now()-k)/N;if(o>1){await P(1),m();return}await P(o),requestAnimationFrame(h)})()})}return W},x=async a=>{const t=await fetch(a),s=new $(t.body),p=await s.ready,c=await s.getInfo();return{clip:s,mp4Info:c,body:p}},I=i(),M=i(),V=i(),U=i(),l=i(!1),f=async a=>{await I.value(2.9,3.3,2,a),l.value||await f(!a)},q=te.debounce(async(a,t)=>{a.width=window.innerWidth*window.devicePixelRatio,a.height=window.innerHeight*window.devicePixelRatio},300);J(async()=>{r.value.volume=.05;const a=U.value,t=a.getContext("2d"),s=await x(ee);I.value=await b(a,t,s);const p=await x(j);M.value=await b(a,t,p);const c=await x(B);V.value=await b(a,t,c),q(a,t),window.addEventListener("resize",()=>{q(a,t)}),await f()});const L=async()=>{l.value=!0,setTimeout(()=>{requestAnimationFrame(async()=>{S.value.play(),await M.value(),l.value=!1,await f()})},2e3)},T=async()=>{l.value=!0,setTimeout(()=>{requestAnimationFrame(async()=>{C.value.play(),await V.value(),l.value=!1,await f()})},2e3)};return(a,t)=>(K(),O("div",se,[e("img",{class:"abs-content bg",src:"./ai/bg.png",alt:""},null,8,ne),e("img",{class:"abs-start-bottom w-100% footer",src:"./ai/footer.png",alt:""},null,8,ie),e("img",{class:"abs-start-bottom house",src:"./ai/house-left.png",alt:""},null,8,ce),e("img",{class:"abs-end-bottom house",src:"./ai/house-right.png",alt:""},null,8,re),e("img",{class:"abs-start w-183px left-13% top-5% yun-up",src:"./ai/yun-up.png",alt:""},null,8,le),e("img",{class:"abs-end-bottom right-13% bottom-30px yun-down",src:"./ai/yun-down.png",alt:""},null,8,pe),e("img",{class:"abs-start w-300px top-10% left--70px jack-left",src:"./ai/jack-left.png",alt:""},null,8,de),e("img",{class:"abs-end w-300px top-10% right--70px jack-right",src:"./ai/jack-right.png",alt:""},null,8,fe),e("canvas",{class:"abs-content",ref_key:"canvasRef",ref:U},null,512),e("div",ue,[e("div",{class:"bg-#fff1 hover:bg-#fff5 w-100px p-15px b-rd-y-10px cursor-pointer flex-center flex-col",onClick:_(D,["stop"])},[g(n(v),{name:"yinyue"}),he],8,me),e("div",{class:"bg-#fff1 hover:bg-#fff5 w-100px p-15px b-rd-y-10px cursor-pointer flex-center flex-col",onClick:t[0]||(t[0]=_((...s)=>n(R)&&n(R)(...s),["stop"]))},[g(n(v),{name:"quanping"}),_e]),e("div",{class:"bg-#fff1 hover:bg-#fff5 w-100px p-15px b-rd-y-10px cursor-pointer flex-center flex-col",onClick:_(L,["stop"])},[g(n(v),{name:"bainian"}),ve],8,ge),e("div",{class:"bg-#fff1 hover:bg-#fff5 w-100px p-15px b-rd-y-10px cursor-pointer flex-center flex-col",onClick:_(T,["stop"])},[g(n(v),{name:"fu","not-fill":""}),be],8,we)]),e("div",xe,[e("audio",{src:n(oe),autoplay:"",ref_key:"audioRef",ref:r,loop:""},null,8,ye),e("video",{ref_key:"bainianRef",ref:S,src:n(j)},null,8,ke),e("video",{ref_key:"perorationRef",ref:C,src:n(B)},null,8,Re)])]))}});const Pe=Y(Se,[["__scopeId","data-v-c791f772"]]);export{Pe as default};
