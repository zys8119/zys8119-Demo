import{d as v,r as d,h as w,aK as S,o as f,c as u,a as t,F as y,b,t as x,aJ as E,p as D,e as k,_ as I}from"./index-3551bf4b.js";import{h as P}from"./index-70468c8b.js";const i=n=>(D("data-v-3ca4df10"),n=n(),k(),n),R={class:"aaa"},L=i(()=>t("h1",null,"这是同屏的内容区域",-1)),B=i(()=>t("div",{class:"text-#fff bg-#f00"},"阿斯科利大量三等奖",-1)),C=i(()=>t("div",{class:"text-#fff bg-#f00 flex justify-between"},[t("span",null,"left"),t("span",null,"right")],-1)),J=v({__name:"sameScreenPage",setup(n){const{query:l}=E(),{send:_,ws:p}=P(l.wsUrl,{autoReconnect:!0}),g=d(),h=d(),c={},m=async(a,s)=>{const e=new RTCPeerConnection({iceServers:[{urls:"stun:127.0.0.1:3478"}]});a.getTracks().forEach(r=>{e.addTrack(r,a)});let o=!1;return e.onicecandidate=r=>{r.candidate&&!o&&(o=!0,s==null||s(e))},await e.setLocalDescription(await e.createOffer()),e};return w(async()=>{const a=await navigator.mediaDevices.getDisplayMedia();p.value.addEventListener("message",async s=>{const e=JSON.parse(s.data)||{};switch(e.emit){case"webrtcLogin":c[e.userId]=await m(a,o=>{_(JSON.stringify({emit:"webrtcStart",data:o.localDescription,userId:e.userId}))});break;case"webrtcResponse":c[e.userId]&&await c[e.userId].setRemoteDescription(e.data);break}})}),S(a=>{console.log(a)}),(a,s)=>(f(),u("div",R,[t("canvas",{ref_key:"canvas",ref:g,class:"hidden w=0 h-0"},null,512),t("div",{ref_key:"contentEl",ref:h,id:"contentEl",class:"bg-#fff w-100% h-100% absolute of-x-hidden"},[L,B,C,(f(),u(y,null,b(100,e=>t("div",null,x(e),1)),64))],512)]))}});const O=I(J,[["__scopeId","data-v-3ca4df10"]]);export{O as default};
