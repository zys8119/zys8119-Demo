import{d as P,r as u,s as L,g as M,o as v,c as m,u as C,C as b,F as z,b as G,D as H,k as J,E as K,l as Q,t as W,_ as X}from"./index-ee812f84.js";import{l as Z}from"./lodash-d2667470.js";import"./_commonjsHelpers-87174ba5.js";const k={class:"draggable"},ee=["onDragenter","onDrop"],te=P({__name:"draggable",props:{modelValue:null,time:null,await:{type:Boolean},fieldName:{type:Boolean}},emits:["update:modelValue"],setup(h,{emit:R}){const f=h,s=u([]);L(async()=>{s.value=f.modelValue});const g=u(),_=M(()=>f.time||.5),y=u(!0),x=u(!0),w=u(-1),D=u(-1),T=Z.debounce(e=>{O(w.value,e)}),V=e=>{x.value=!1,w.value=s.value.findIndex(o=>o.el===e.target)},F=e=>{const o=g.value.getBoundingClientRect().top,{key:n}=s.value.map(t=>t.el.getBoundingClientRect().height).reduce((t,r,d)=>(t.value+r<=e.clientY-o&&(t.value+=r,t.key=d),t),{key:0,value:0});D.value=n,T(D.value)},I=()=>{x.value=!0,T(D.value)},N=(e,o,n)=>{e.style.transform=`translateY(${o}px)`,n&&(e.style.background="#e8e8e8"),requestAnimationFrame(()=>{e.style.transition=`transform ${_.value}s`,e.style.transform="translateY(0px)",e.offsetTop,requestAnimationFrame(()=>{e.style.removeProperty("transform"),setTimeout(()=>{e.style.removeProperty("transition")},_.value*1e3)})})},B=e=>{const o=[];s.value.forEach((n,t)=>{const r=e.find(d=>d.start===t);r?o[r.end]=s.value[t]:o[t]=n}),s.value=o,R("update:modelValue",s.value),y.value=!1,K(()=>{y.value=!0})},c=u(0),O=(e,o)=>{var E;const n=e<=o,t=s.value.reduce((l,i,a)=>{const p=o>c.value,Y=p&&a>=e&&a<=o,$=!p&&a>=e&&a<=o||a===c.value,q=!p&&a>=o&&a<=e,A=p&&a>=o&&a<=e||a===c.value;return(n&&(Y||$)||!n&&(q||A))&&l.push({name:i.name,el:i.el,start:a,end:a===e?o:n?a-1:a+1}),l},[]),r=n?t[0]:t[t.length-1],d=s.value[r.start].el,U=(E=s.value[r.end+(n?1:0)])==null?void 0:E.el,j=t.map(l=>l.el.getBoundingClientRect().top);g.value.insertBefore(d,U);const S=t.map(l=>l.el.getBoundingClientRect().top);j.forEach((l,i)=>{const a=t[i];N(a.el,l-S[i],a.start===e)}),c.value=o,x.value&&(f.await?setTimeout(()=>{B(t)},_.value*1e3):B(t))};return(e,o)=>(v(),m("div",k,[C(y)?(v(),m("div",{key:0,class:"b-#d8d8d8 b-solid b-1px b-rd-5px p-y-15px",ref_key:"ulRef",ref:g,onDragenter:b(F,["prevent"]),onDragover:o[0]||(o[0]=b(()=>{},["prevent"])),onDrop:b(I,["prevent"])},[(v(!0),m(z,null,G(C(s),(n,t)=>(v(),m("div",{"data-target":"",onDragstart:V,ref_for:!0,ref:r=>n.el=r,class:"m-b-5px p-x-15px",draggable:"true",key:t},[H(e.$slots,"default",{data:n,index:t},()=>[Q(W(n[h.fieldName||"name"]),1)],!0)],32))),128))],40,ee)):J("",!0)]))}});const se=X(te,[["__scopeId","data-v-7d040e37"]]);export{se as default};
