import{g as u}from"./index-751a38a1.js";import{d as _,r as p,h as f,R as m,o as v,c as l,a as w,_ as g}from"./index-76c60e35.js";const S={class:"aaa"},y=_({__name:"sameScreen",setup(b){const{send:c,ws:i}=u("ws://123.60.16.78:50200/websocket/websocket",{autoReconnect:!0}),s=p(),n={},d=async(t,a)=>{const e=new RTCPeerConnection({iceServers:[{urls:"stun:127.0.0.1:3478"}]});t.getTracks().forEach(r=>{e.addTrack(r,t)});let o=!1;return e.onicecandidate=r=>{r.candidate&&!o&&(o=!0,a==null||a(e))},await e.setLocalDescription(await e.createOffer()),e};return f(async()=>{const t=await navigator.mediaDevices.getUserMedia({video:!0});s.value.srcObject=t,s.value.onloadedmetadata=function(a){s.value.play()},i.value.addEventListener("message",async a=>{const e=JSON.parse(a.data)||{};switch(e.emit){case"webrtcLogin":n[e.userId]=await d(t,o=>{c(JSON.stringify({emit:"webrtcStart",data:o.localDescription,userId:e.userId}))});break;case"webrtcResponse":n[e.userId]&&await n[e.userId].setRemoteDescription(e.data);break}})}),m(t=>{console.log(t)}),(t,a)=>(v(),l("div",S,[w("video",{ref_key:"video",ref:s},null,512)]))}});const R=g(y,[["__scopeId","data-v-8dbdf981"]]);export{R as default};
